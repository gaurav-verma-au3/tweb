const __vite__fileDeps=["./pageIm-Dji0D0b9.js","./index-BpkmQJ7B.js","./index-dzKQggTO.css","./page-DRs10BYM.js","./pageAuthCode-SOjzkOXr.js","./codeInputField-DZ9DGEN8.js","./wrapEmojiText-DlCOpVys.js","./button-CIRTFHo6.js","./putPreloader-diAA0Z4w.js","./countryInputField-DnVrcaQU.js","./scrollable-C_2j_KpO.js","./pageSignQR-BG_3gzlZ.js","./textToSvgURL-Cnw_Q8Rw.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{a as s,b as x,c as I,d as F,i as h,A as T,_ as P,e as w,I as O,f as V,g as B}from"./index-BpkmQJ7B.js";import{p as U}from"./putPreloader-diAA0Z4w.js";import{P as H,a as K}from"./page-DRs10BYM.js";import{C as W,T as q,a as z}from"./countryInputField-DnVrcaQU.js";import{B as A,r as Q}from"./button-CIRTFHo6.js";import{p as $,l as j,t as D,r as y}from"./wrapEmojiText-DlCOpVys.js";import{p as R,g as G}from"./pageSignQR-BG_3gzlZ.js";import"./scrollable-C_2j_KpO.js";import"./textToSvgURL-Cnw_Q8Rw.js";let a=null,l;const J=()=>{const g=document.createElement("div");g.classList.add("input-wrapper");let f,E;const d=new W({onCountryChange:(e,t)=>{f=e,E=t,t&&(i.value=i.lastValue="+"+t.country_code,setTimeout(()=>{p.focus(),$(p,!0)},0))}}),i=new q({onInput:e=>{j.loadLottieWorkers();const{country:t,code:o}=e||{},n=t?t.name||t.default_name:"";n!==d.value&&(!f||!t||!o||f!==t&&E.country_code!==o.country_code)&&d.override(t,o,n),t||i.value.length-1>1?a.style.visibility="":a.style.visibility="hidden"}}),p=i.input;p.addEventListener("keypress",e=>{if(!a.style.visibility&&e.key==="Enter")return C()});const c=new z({text:"Login.KeepSigned",name:"keepSession",withRipple:!0,checked:!0});c.input.addEventListener("change",()=>{const e=c.checked;s.managers.appStateManager.pushToState("keepSigned",e),x.toggleStorages(e,!0)}),x.getState().then(e=>{I.isAvailable()?c.checked=e.keepSigned:(c.checked=!1,c.label.classList.add("checkbox-disabled"))}),a=A("btn-primary btn-color-primary",{text:"Login.Next"}),a.style.visibility="hidden";const C=e=>{e&&F(e);const t=D([a,l],!0);y(a,h("PleaseWait")),U(a);const o=i.value;s.managers.apiManager.invokeApi("auth.sendCode",{phone_number:o,api_id:T.id,api_hash:T.hash,settings:{_:"codeSettings",pFlags:{}}}).then(async n=>{if(n._==="auth.sentCodeSuccess"){const{authorization:r}=n;r._==="auth.authorization"&&(await s.managers.apiManager.setUser(r.user),P(()=>import("./pageIm-Dji0D0b9.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(k=>{k.default.mount()}))}P(()=>import("./pageAuthCode-SOjzkOXr.js"),__vite__mapDeps([4,1,2,3,5,6,7,8,9,10,11,12]),import.meta.url).then(r=>r.default.mount(Object.assign(n,{phone_number:o})))}).catch(n=>{switch(t(),n.type){case"PHONE_NUMBER_INVALID":i.setError(),y(i.label,h("Login.PhoneLabelInvalid")),p.classList.add("error"),y(a,h("Login.Next"));break;default:console.error("auth.sendCode error:",n),a.innerText=n.type;break}})};K(a,C),l=A("btn-primary btn-secondary btn-primary-transparent primary",{text:"Login.QR.Login"});const _=document.createElement("div");_.classList.add("text-center"),_.innerHTML=`<span>To use our service, you need an active Telegram account. If you don't have one, download the<a href="https://play.google.com/store/apps/details?id=org.telegram.messenger&amp;hl=en&amp;gl=US" target="_blank" rel="noopener noreferrer"> Telegram app </a>from your app store and create an account first</span>`,l.addEventListener("click",()=>{R.mount()}),g.append(d.container,i.container,c.label,a,l,_);const m=document.createElement("div");m.classList.add("flex-div-title-container");const v=new Image;v.classList.add("tg-logo-small-inline"),v.src="https://i.ibb.co/HnLSvKn/square.png",m.append(v);const b=document.createElement("h4");b.classList.add("text-center"),w(b,"Login.Title"),m.append(b);const L=document.createElement("div");L.classList.add("subtitle","text-center"),w(L,"Login.StartText"),X.pageEl.querySelector(".container").append(m,L,g);const M=()=>{s.managers.apiManager.invokeApi("help.getNearestDc").then(e=>{const t=I.getFromCache("langPack");t&&!t.countries?.hash&&V.getLangPack(t.lang_code).then(()=>{i.simulateInputEvent()});const o=new Set([1,2,3,4,5]),n=[e.this_dc];let r;return e.nearest_dc!==e.this_dc&&(r=s.managers.apiManager.getNetworkerVoid(e.nearest_dc).then(()=>{n.push(e.nearest_dc)})),(r||Promise.resolve()).then(()=>{n.forEach(u=>{o.delete(u)});const k=[...o],S=async()=>{const u=k.shift();if(!u)return;const N=`dc${u}_auth_key`;if(await B.get(N))return S();setTimeout(()=>{s.managers.apiManager.getNetworkerVoid(u).finally(S)},3e3)};S()}),e}).then(e=>{!d.value.length&&!i.value.length&&d.selectCountryByIso2(e.country)})};O||setTimeout(()=>{p.focus()},0),G(g),M()},X=new H("page-sign",!0,J,()=>{a&&(y(a,h("Login.Next")),Q(a,void 0,void 0,!0),a.removeAttribute("disabled")),l&&l.removeAttribute("disabled"),s.managers.appStateManager.pushToState("authState",{_:"authStateSignIn"})});export{X as default};
//# sourceMappingURL=pageSignIn-rbSG92e7.js.map
